{"version":3,"file":"my.js","sources":["pages/index/my.uvue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvbXkudXZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 顶部数据区域 -->\r\n\t\t<view class=\"data-section\">\r\n\t\t\t<text class=\"section-title\">我的数据</text>\r\n\t\t\t<view class=\"data-list\">\r\n\t\t\t\t<view class=\"data-list-item\">\r\n\t\t\t\t\t<text class=\"data-list-label\">总里程</text>\r\n\t\t\t\t\t<text class=\"data-list-value\">{{totalDistance}} km</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"data-list-item\">\r\n\t\t\t\t\t<text class=\"data-list-label\">最快速度</text>\r\n\t\t\t\t\t<text class=\"data-list-value\">{{maxSpeed}} km/h</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"data-list-item\">\r\n\t\t\t\t\t<text class=\"data-list-label\">最长时间</text>\r\n\t\t\t\t\t<text class=\"data-list-value\">{{maxTime}} h</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 中间历史骑行数据区域 -->\r\n\t\t<view class=\"history-section\">\r\n\t\t\t<text class=\"section-title\">历史骑行数据</text>\r\n\t\t\t<view class=\"history-list\">\r\n\t\t\t\t<view class=\"history-item\" v-for=\"(item, index) in historyData\" :key=\"index\">\r\n\t\t\t\t\t<view class=\"history-date\">\r\n\t\t\t\t\t\t<text class=\"date-text\">{{item.date}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"history-details\">\r\n\t\t\t\t\t\t<text class=\"time-text\">{{item.time}}</text>\r\n\t\t\t\t\t\t<text class=\"location-text\">{{item.location}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 底部设备区域 -->\r\n\t\t<view class=\"device-section\">\r\n\t\t\t<text class=\"section-title\">我的设备</text>\r\n\t\t\t<view class=\"device-container\">\r\n\t\t\t\t<view class=\"device-box\" @click=\"toggleBluetooth\">\r\n\t\t\t\t\t<text class=\"device-name\">{{deviceName}}</text>\r\n\t\t\t\t\t<text class=\"device-status\">{{deviceStatus}}</text>\r\n\t\t\t\t\t<text class=\"search-hint\" v-if=\"isSearching\">搜索中...</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<!-- 设备信息显示区域 -->\r\n\t\t\t<view class=\"device-info-section\" v-if=\"deviceInfo.show\">\r\n\t\t\t\t<view class=\"device-info-item\">\r\n\t\t\t\t\t<text class=\"device-info-label\">设备名称:</text>\r\n\t\t\t\t\t<text class=\"device-info-value\">{{deviceInfo.name || '未知'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"device-info-item\">\r\n\t\t\t\t\t<text class=\"device-info-label\">连接状态:</text>\r\n\t\t\t\t\t<text class=\"device-info-value\" :class=\"deviceInfo.connected ? 'connected' : 'disconnected'\">\r\n\t\t\t\t\t\t{{deviceInfo.connected ? '已连接' : '未连接'}}\r\n\t\t\t\t\t</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"device-info-item\">\r\n\t\t\t\t\t<text class=\"device-info-label\">型号:</text>\r\n\t\t\t\t\t<text class=\"device-info-value\">{{deviceInfo.model || '未知'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"device-info-item\">\r\n\t\t\t\t\t<text class=\"device-info-label\">序列号:</text>\r\n\t\t\t\t\t<text class=\"device-info-value\">{{deviceInfo.serialNumber || '未知'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"device-info-item\">\r\n\t\t\t\t\t<text class=\"device-info-label\">固件版本:</text>\r\n\t\t\t\t\t<text class=\"device-info-value\">{{deviceInfo.firmwareVersion || '未知'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"device-info-item\">\r\n\t\t\t\t\t<text class=\"device-info-label\">硬件版本:</text>\r\n\t\t\t\t\t<text class=\"device-info-value\">{{deviceInfo.hardwareVersion || '未知'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"device-info-item\">\r\n\t\t\t\t\t<text class=\"device-info-label\">软件版本:</text>\r\n\t\t\t\t\t<text class=\"device-info-value\">{{deviceInfo.softwareVersion || '未知'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"device-info-item\">\r\n\t\t\t\t\t<text class=\"device-info-label\">制造商:</text>\r\n\t\t\t\t\t<text class=\"device-info-value\">{{deviceInfo.manufacturer || '未知'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"device-info-item\">\r\n\t\t\t\t\t<text class=\"device-info-label\">电池电量:</text>\r\n\t\t\t\t\t<text class=\"device-info-value battery\">{{deviceInfo.batteryLevel || '未知'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<!-- 设备列表 -->\r\n\t\t\t<view class=\"device-list\" v-if=\"discoveredDevices.length > 0\">\r\n\t\t\t\t<view class=\"device-list-item\" v-for=\"(device, index) in discoveredDevices\" :key=\"index\"\r\n\t\t\t\t\t@click=\"connectDevice(device)\">\r\n\t\t\t\t\t<text class=\"device-item-name\">{{device.name || '未知设备'}}</text>\r\n\t\t\t\t\t<text class=\"device-item-signal\">信号强度: {{device.RSSI}}dBm</text>\r\n\t\t\t\t\t<view class=\"device-item-actions\">\r\n\t\t\t\t\t\t<view class=\"action-button\" @click.stop=\"disconnectDevice(device)\" v-if=\"device.connected\">\r\n\t\t\t\t\t\t\t<text class=\"action-text\">断开</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"action-button\" @click.stop=\"removeDevice(device)\">\r\n\t\t\t\t\t\t\t<text class=\"action-text\">移除</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\r\n\r\n\t</view>\r\n</template>\r\n\r\n<script lang=\"uts\">export default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t// 数据展示\r\n\t\t\t\ttotalDistance: 128.5,\r\n\t\t\t\tmaxSpeed: 35.2,\r\n\t\t\t\tmaxTime: 4.5,\r\n\t\t\t\t// 历史骑行数据\r\n\t\t\t\thistoryData: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdate: '2023-06-15',\r\n\t\t\t\t\t\ttime: '14:30 - 16:45',\r\n\t\t\t\t\t\tlocation: '城市公园'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdate: '2023-06-10',\r\n\t\t\t\t\t\ttime: '09:15 - 11:30',\r\n\t\t\t\t\t\tlocation: '湖边绿道'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdate: '2023-06-05',\r\n\t\t\t\t\t\ttime: '16:00 - 18:20',\r\n\t\t\t\t\t\tlocation: '山地赛道'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdate: '2023-05-28',\r\n\t\t\t\t\t\ttime: '10:30 - 13:15',\r\n\t\t\t\t\t\tlocation: '滨江路'\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\t// 设备信息\r\n\t\t\t\tdeviceName: '智能骑行传感器 A1',\r\n\t\t\t\tdeviceStatus: '未连接',\r\n\t\t\t\t// 蓝牙相关数据\r\n\t\t\t\tisSearching: false,\r\n\t\t\t\tdiscoveredDevices: [],\r\n\t\t\t\tconnectedDeviceId: '',\r\n\t\t\t\tbluetoothEnabled: false,\r\n\t\t\t\tsearchTimer: null,\r\n\t\t\t\t// 设备详细信息\r\n\t\t\tdeviceInfo: {\r\n\t\t\t\tshow: false,\r\n\t\t\t\tmodel: '',\r\n\t\t\t\tserialNumber: '',\r\n\t\t\t\tfirmwareVersion: '',\r\n\t\t\t\thardwareVersion: '',\r\n\t\t\t\tsoftwareVersion: '',\r\n\t\t\t\tmanufacturer: '',\r\n\t\t\t\tbatteryLevel: '',\r\n\t\t\t\tname: '',\r\n\t\t\t\tconnected: false\r\n\t\t\t},\r\n\t\t\t// 蓝牙服务和特征值存储\r\n\t\t\tbleServices: {},\r\n\t\t\tbleCharacteristics: {},\r\n\t\t\t// 监听器状态\r\n\t\t\tcharacteristicListenerSet: false,\r\n\t\t\t// 连接状态监控\r\n\t\t\tconnectionMonitorInterval: null,\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\t// 页面加载时只初始化数据，不初始化蓝牙\r\n\t\t\tthis.initData();\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t// 页面显示时检查是否已有连接设备，如果没有则初始化蓝牙并开始搜索\r\n\t\tuni.__f__('log','at pages/index/my.uvue:180','页面显示，检查连接状态');\r\n\t\tconst savedDeviceId = uni.getStorageSync('connectedDeviceId');\r\n\t\tif (!savedDeviceId) {\r\n\t\t\tthis.initBluetooth();\r\n\t\t\t// 延迟一下确保蓝牙初始化完成，然后开始搜索\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.searchDevices();\r\n\t\t\t}, 500);\r\n\t\t} else {\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:189','已有连接设备，不重新搜索');\r\n\t\t\t// 已有连接设备，直接检查连接状态\r\n\t\t\tthis.checkConnectedDevice();\r\n\t\t}\r\n\t},\r\n\t\tonUnload() {\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:195','页面卸载');\r\n\t\t\t// 停止搜索\r\n\t\t\tthis.stopSearchDevices();\r\n\t\t\t// 停止连接监控，但不主动断开设备连接，保持连接稳定性\r\n\t\t\tthis.stopConnectionMonitor();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 初始化数据\r\n\t\t\tinitData() {\r\n\t\t\t\t// 这里可以从本地存储或服务器获取数据\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:205','我的页面数据初始化');\r\n\t\t\t},\r\n\r\n\t\t\t// 初始化蓝牙适配器\r\n\t\tinitBluetooth() {\r\n\t\t\t// 保存当前组件实例的this引用\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:212','初始化蓝牙适配器');\r\n\r\n\t\t\t// 监听蓝牙状态变化\r\n\t\t\tuni.onBluetoothAdapterStateChange((res) => {\r\n\t\t\t\tif (!res.available) {\r\n\t\t\t\t\tthat.deviceStatus = '蓝牙不可用';\r\n\t\t\t\t\tthat.bluetoothEnabled = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthat.bluetoothEnabled = true;\r\n\t\t\t\t\tthat.deviceStatus = '蓝牙已就绪';\r\n\t\t\t\t\t// 蓝牙可用时自动搜索设备，但只有在没有连接设备时才搜索\r\n\t\t\t\t\tif (res.discovering || that.connectedDeviceId) {\r\n\t\t\t\t\t\t// 如果已经在搜索中，或者已经连接了设备，则不重复搜索\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 延迟2秒开始搜索，确保蓝牙完全就绪\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthat.searchDevices();\r\n\t\t\t\t\t}, 2000);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// 检查蓝牙是否可用\r\n\t\tuni.getBluetoothAdapterState({\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:237','getBluetoothAdapterState', res);\r\n\t\t\t\tif (!res.available) {\r\n\t\t\t\t\tthat.deviceStatus = '蓝牙不可用';\r\n\t\t\t\t\tthat.bluetoothEnabled = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthat.bluetoothEnabled = true;\r\n\t\t\t\t\tthat.deviceStatus = '蓝牙已就绪';\r\n\t\t\t\t\t// 蓝牙可用时自动搜索设备，但只有在没有连接设备时才搜索\r\n\t\t\t\t\tif (!res.discovering && !that.connectedDeviceId) {\r\n\t\t\t\t\t\t// 延迟2秒开始搜索，确保蓝牙完全就绪\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthat.searchDevices();\r\n\t\t\t\t\t\t}, 2000);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:254','获取蓝牙适配器状态失败', err);\r\n\t\t\t\t\tthat.deviceStatus = '蓝牙不可用';\r\n\t\t\t\t\tthat.bluetoothEnabled = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\r\n\t\t\t// 切换蓝牙开关\r\n\t\ttoggleBluetooth() {\r\n\t\tconst that = this;\r\n\t\tif (that.bluetoothEnabled) {\r\n\t\t\tthat.closeBluetooth();\r\n\t\t} else {\r\n\t\t\t// 第一次点击时才初始化蓝牙适配器\r\n\t\t\tthat.initBluetooth();\r\n\t\t\tthat.openBluetooth();\r\n\t\t}\r\n\t},\r\n\r\n\r\n\r\n\t\t\t// 打开蓝牙\r\n\t\topenBluetooth() {\r\n\t\t\t// 保存当前组件实例的this引用\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:280','打开蓝牙');\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:281',uni.getSystemInfoSync().platform);\r\n\t\t\tif (uni.getSystemInfoSync().platform === 'android') {\r\n\t\t\t\t// Android平台\r\n\t\t\t\tuni.openBluetoothAdapter({\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:286','openBluetoothAdapter success', res);\r\n\t\t\t\t\t\tthat.bluetoothEnabled = true;\r\n\t\t\t\t\t\tthat.deviceStatus = '蓝牙已开启';\r\n\t\t\t\t\t\t// 自动开始搜索设备\r\n\t\t\t\t\t\tthat.searchDevices();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (res) => {\r\n\t\t\t\t\t\tif (res.errCode === 10001) {\r\n\t\t\t\t\t\t\tuni.onBluetoothAdapterStateChange((res) => {\r\n\t\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:295','onBluetoothAdapterStateChange', res);\r\n\t\t\t\t\t\t\t\tif (res.available) {\r\n\t\t\t\t\t\t\t\t\tthat.bluetoothEnabled = true;\r\n\t\t\t\t\t\t\t\t\tthat.deviceStatus = '蓝牙已开启';\r\n\t\t\t\t\t\t\t\t\t// 自动开始搜索设备\r\n\t\t\t\t\t\t\t\t\tthat.searchDevices();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.deviceStatus = '蓝牙开启失败';\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else if (uni.getSystemInfoSync().platform === 'ios') {\r\n\t\t\t\t// iOS平台\r\n\t\t\t\tuni.openBluetoothAdapter({\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:311','openBluetoothAdapter success', res);\r\n\t\t\t\t\t\tthat.bluetoothEnabled = true;\r\n\t\t\t\t\t\tthat.deviceStatus = '蓝牙已开启';\r\n\t\t\t\t\t\t// 自动开始搜索设备\r\n\t\t\t\t\t\tthat.searchDevices();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (res) => {\r\n\t\t\t\t\t\tthat.deviceStatus = '蓝牙开启失败';\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t\t// 关闭蓝牙\r\n\t\tcloseBluetooth() {\r\n\t\t\t// 保存当前组件实例的this引用\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:328','关闭蓝牙');\r\n\t\t\tuni.closeBluetoothAdapter({\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:331','关闭蓝牙适配器成功', res);\r\n\t\t\t\t\tthat.bluetoothEnabled = false;\r\n\t\t\t\t\tthat.deviceStatus = '蓝牙已关闭';\r\n\t\t\t\t\t// 断开所有连接的设备\r\n\t\t\t\t\tthat.disconnectAllDevices();\r\n\t\t\t\t\t// 清空设备列表\r\n\t\t\t\t\tthat.discoveredDevices = [];\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:340','关闭蓝牙适配器失败', err);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t\t// 判断数组中是否包含某个元素\r\n\t\t\tinArray(arr, key, val) {\r\n\t\t\t\tfor (let i = 0; i < arr.length; i++) {\r\n\t\t\t\t\tif (arr[i][key] === val) {\r\n\t\t\t\t\t\treturn i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn -1;\r\n\t\t\t},\r\n\r\n\t\t\t// 搜索设备\r\n\t\tsearchDevices() {\r\n\t\t\t// 保存当前组件实例的this引用，确保在所有回调中都能正确访问\r\n\t\t\tconst that = this;\r\n\r\n\t\t\tif (!that.bluetoothEnabled) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请先开启蓝牙',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (that.isSearching) {\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:369','正在搜索中，请稍候...');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:373','开始搜索蓝牙设备');\r\n\t\t\tthat.isSearching = true;\r\n\t\t\tthat.deviceStatus = '搜索中...';\r\n\t\t\tthat.discoveredDevices = [];\r\n\t\t\tthat.deviceInfo.show = false;\r\n\r\n\t\t\t// 清除之前可能存在的搜索定时器和超时定时器\r\n\t\t\tif (that.searchTimer) {\r\n\t\t\t\tclearInterval(that.searchTimer);\r\n\t\t\t\tthat.searchTimer = null;\r\n\t\t\t}\r\n\t\t\tif (that.searchTimeoutTimer) {\r\n\t\t\t\tclearTimeout(that.searchTimeoutTimer);\r\n\t\t\t\tthat.searchTimeoutTimer = null;\r\n\t\t\t}\r\n\r\n\t\t\t// 用于控制日志输出频率的变量\r\n\t\t\tthat.lastLogTime = {};\r\n\t\t\tthat.logInterval = 2000; // 日志输出间隔，单位毫秒\r\n\r\n\t\t\t// 使用uni-app的蓝牙API\r\n\t\t\tuni.openBluetoothAdapter({\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:396','蓝牙适配器已打开', res);\r\n\r\n\t\t\t\t\t// 开始搜索设备，指定设备发现服务UUID\r\n\t\t\t\t\tuni.startBluetoothDevicesDiscovery({\r\n\t\t\t\t\t\tallowDuplicatesKey: false,  // 不允许重复上报设备，解决信号强度刷新过快问题\r\n\t\t\t\t\t\t// services: ['0xADB401C0B1C6-11ED-AFA1-0242AC120002'], // 设备发现服务UUID\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:403','开始搜索设备', res);\r\n\r\n\t\t\t\t\t\t\t// 监听发现新设备事件\r\n\t\t\t\t\t\t\tuni.onBluetoothDeviceFound((res) => {\r\n\t\t\t\t\t\t\t\t// 只有在未连接设备时才处理新设备和输出日志\r\n\t\t\t\t\t\t\t\tif (that.connectedDeviceId) {\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tres.devices.forEach(device => {\r\n\t\t\t\t\t\t\t\t\tif (!device.name && !device.localName) {\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t// 获取当前时间戳\r\n\t\t\t\t\t\t\t\t\tconst now = Date.now();\r\n\t\t\t\t\t\t\t\t\tconst deviceId = device.deviceId;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// 检查是否应该输出日志（每2秒只输出一次相同设备的日志）\r\n\t\t\t\t\t\t\t\t\tif (!that.lastLogTime[deviceId] || (now - that.lastLogTime[deviceId] >= that.logInterval)) {\r\n\t\t\t\t\t\t\t\t\t\t// 更新最后输出日志的时间\r\n\t\t\t\t\t\t\t\t\t\tthat.lastLogTime[deviceId] = now;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t// 只输出必要的日志信息\r\n\t\t\t\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:427','发现设备:', device.name, 'ID:', deviceId);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tconst foundDevices = that.discoveredDevices;\r\n\t\t\t\t\t\t\t\t\tconst idx = that.inArray(foundDevices, 'deviceId', deviceId);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif (idx === -1) {\r\n\t\t\t\t\t\t\t\t\t\t// 过滤设备，只显示名称中包含\"RideHDD\"的设备\r\n\t\t\t\t\t\t\t\t\t\tif (device.name && device.name.includes('RideHDD')) {\r\n\t\t\t\t\t\t\t\t\t\t\t// 只在添加新设备时输出详细日志\r\n\t\t\t\t\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:437','添加新设备:', device.name);\r\n\t\t\t\t\t\t\t\t\t\t\tconst newDevice = {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdeviceId: deviceId,\r\n\t\t\t\t\t\t\t\t\t\t\t\tname: device.name,\r\n\t\t\t\t\t\t\t\t\t\t\t\tRSSI: device.RSSI,\r\n\t\t\t\t\t\t\t\t\t\t\t\tconnected: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\tlastRssiUpdateTime: now // 添加最后更新时间\r\n\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\tthat.discoveredDevices.push(newDevice);\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t// 自动连接设备\r\n\t\t\t\t\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:448','尝试连接设备:', device.name);\r\n\t\t\t\t\t\t\t\t\t\t\tthat.connectDevice(newDevice);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t// 添加时间限制，控制信号强度更新频率（每2秒更新一次）\r\n\t\t\t\t\t\t\t\t\t\tconst rssiUpdateInterval = 2000; // 2秒\r\n\t\t\t\t\t\t\t\t\t\tconst deviceInfo = that.discoveredDevices[idx];\r\n\t\t\t\t\t\t\t\t\t\tconst lastUpdateTime = deviceInfo.lastRssiUpdateTime || 0;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t// 只有当超过更新间隔或信号强度变化较大时才更新\r\n\t\t\t\t\t\t\t\t\t\tif (now - lastUpdateTime >= rssiUpdateInterval || \r\n\t\t\t\t\t\t\t\t\t\t    Math.abs(device.RSSI - deviceInfo.RSSI) > 5) {\r\n\t\t\t\t\t\t\t\t\t\t\tthat.discoveredDevices[idx] = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t...deviceInfo,\r\n\t\t\t\t\t\t\t\t\t\t\t\tRSSI: device.RSSI,\r\n\t\t\t\t\t\t\t\t\t\t\t\tname: device.name || deviceInfo.name,\r\n\t\t\t\t\t\t\t\t\t\t\t\tlastRssiUpdateTime: now\r\n\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t// 检查设备是否已连接，如果未连接则尝试连接（每2秒只尝试一次）\r\n\t\t\t\t\t\t\t\t\t\tif (!that.discoveredDevices[idx].connected && !that.connectedDeviceId) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (!that.lastConnectAttempt || (now - that.lastConnectAttempt >= that.logInterval)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthat.lastConnectAttempt = now;\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:472','尝试重新连接设备:', device.name);\r\n\t\t\t\t\t\t\t\t\t\t\t\tthat.connectDevice(that.discoveredDevices[idx]);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:481','搜索设备失败', err);\r\n\t\t\t\t\t\t\tthat.isSearching = false;\r\n\t\t\t\t\t\t\tthat.deviceStatus = '搜索失败';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 设置定时器，每2秒检查一次是否需要继续搜索\r\n\t\t\t\t\tthat.searchTimer = setInterval(() => {\r\n\t\t\t\t\t\tif (that.isSearching && !that.connectedDeviceId) {\r\n\t\t\t\t\t\t\t// 减少定时器中的日志输出\r\n\t\t\t\t\t\t\t// 先检查蓝牙适配器状态，避免在未初始化时调用API导致错误\r\n\t\t\t\t\t\t\tuni.getBluetoothAdapterState({\r\n\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t// 只有当蓝牙适配器可用时，才执行搜索操作\r\n\t\t\t\t\t\t\t\t\tif (res.available) {\r\n\t\t\t\t\t\t\t\t\t\t// 只有当没有在搜索时才重新开始搜索，避免频繁停止和启动\r\n\t\t\t\t\t\t\t\t\t\tif (!res.discovering) {\r\n\t\t\t\t\t\t\t\t\t\t\t// 如果没有在搜索，直接开始搜索\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.startBluetoothDevicesDiscovery({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tallowDuplicatesKey: false,  // 不允许重复上报设备\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 减少启动搜索时的日志\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:505','搜索设备失败', err);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:512','获取蓝牙适配器状态失败', err);\r\n\t\t\t\t\t\t\t\t\t// 如果获取状态失败，可能是蓝牙已关闭，更新UI状态\r\n\t\t\t\t\t\t\t\t\tthat.isSearching = false;\r\n\t\t\t\t\t\t\t\t\tif (that.searchTimer) {\r\n\t\t\t\t\t\t\t\t\t\tclearInterval(that.searchTimer);\r\n\t\t\t\t\t\t\t\t\t\tthat.searchTimer = null;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else if (that.connectedDeviceId) {\r\n\t\t\t\t\t\t\t// 如果已经连接了设备，停止搜索\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:523','已连接设备，停止搜索');\r\n\t\t\t\t\t\t\tthat.stopSearchDevices();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 2000);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 添加搜索超时机制，30秒后自动停止搜索\r\n\t\t\t\t\tthat.searchTimeoutTimer = setTimeout(() => {\r\n\t\t\t\t\t\tif (that.isSearching && !that.connectedDeviceId) {\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:531','搜索超时，自动停止搜索');\r\n\t\t\t\t\t\t\tthat.stopSearchDevices();\r\n\t\t\t\t\t\t\tthat.deviceStatus = '搜索超时，请手动重试';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 30000);\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:538','打开蓝牙适配器失败', err);\r\n\t\t\t\t\tthat.isSearching = false;\r\n\t\t\t\t\tthat.deviceStatus = '蓝牙开启失败';\r\n\t\t\t\t\t// 清除定时器\r\n\t\t\t\t\tif (that.searchTimer) {\r\n\t\t\t\t\t\tclearInterval(that.searchTimer);\r\n\t\t\t\t\t\tthat.searchTimer = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t\t// 停止搜索设备\r\n\t\tstopSearchDevices() {\r\n\t\t\t// 保存当前组件实例的this引用\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:554','停止搜索蓝牙设备');\r\n\t\t\t// 清除搜索定时器和超时定时器\r\n\t\t\tif (that.searchTimer) {\r\n\t\t\t\tclearInterval(that.searchTimer);\r\n\t\t\t\tthat.searchTimer = null;\r\n\t\t\t}\r\n\t\t\tif (that.searchTimeoutTimer) {\r\n\t\t\t\tclearTimeout(that.searchTimeoutTimer);\r\n\t\t\t\tthat.searchTimeoutTimer = null;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 清除日志输出控制变量，确保设备连接后完全停止日志输出和刷新\r\n\t\t\tthat.lastLogTime = {};\r\n\t\t\tthat.lastConnectAttempt = null;\r\n\t\t\tthat.logInterval = null;\r\n\t\t\t\t\r\n\t\t\t\t// 先检查蓝牙适配器状态，避免在未初始化时调用停止搜索导致错误\r\n\t\t\t\tuni.getBluetoothAdapterState({\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t// 只有当蓝牙适配器可用且正在搜索时，才调用停止搜索\r\n\t\t\t\t\t\tif (res.available && res.discovering) {\r\n\t\t\t\t\t\t\tuni.stopBluetoothDevicesDiscovery({\r\n\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:577','停止搜索设备成功', res);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:580','停止搜索设备失败', err);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 无论停止搜索是否成功，都更新UI状态\r\n\t\t\t\t\t\tthat.isSearching = false;\r\n\t\t\t\t\t\tif (that.discoveredDevices.length === 0) {\r\n\t\t\t\t\t\t\tthat.deviceStatus = '未找到设备';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthat.deviceStatus = '找到 ' + that.discoveredDevices.length + ' 个设备';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:593','获取蓝牙适配器状态失败', err);\r\n\t\t\t\t\t\t// 即使获取状态失败，也更新UI状态\r\n\t\t\t\t\t\tthat.isSearching = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t// 检查是否有已连接的设备\r\ncheckConnectedDevice() {\r\n\tuni.__f__('log','at pages/index/my.uvue:602','检查设备连接状态');\r\n\tconst savedDeviceId = uni.getStorageSync('connectedDeviceId');\r\n\tconst savedDeviceName = uni.getStorageSync('connectedDeviceName');\r\n\r\n\tif (savedDeviceId) {\r\n\t\tthis.deviceStatus = '检查设备连接状态...';\r\n\t\t\r\n\t\t// 立即更新UI，显示正在检查状态\r\n\t\tthis.$forceUpdate();\r\n\t\t\r\n\t\t// 首先确保蓝牙适配器已初始化\r\n\t\tuni.openBluetoothAdapter({\r\n\t\t\tsuccess: () => {\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:615','蓝牙适配器已开启');\r\n\t\t\t\t// 检查设备是否仍然连接\r\n\t\t\t\tthis.checkDeviceConnection(savedDeviceId, savedDeviceName);\r\n\t\t\t\tthis.bluetoothEnabled = true;\r\n\t\t\t},\r\n\t\t\tfail: (err) => {\r\n\t\t\t\tuni.__f__('error','at pages/index/my.uvue:621','蓝牙适配器未开启，尝试初始化', err);\r\n\t\t\t\t// 如果蓝牙适配器未开启，先初始化蓝牙\r\n\t\t\t\tthis.initBluetooth();\r\n\t\t\t\tthis.bluetoothEnabled = false;\r\n\t\t\t\t// 延迟后再次检查连接状态\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.checkDeviceConnection(savedDeviceId, savedDeviceName);\r\n\t\t\t\t}, 1000);\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\tuni.__f__('log','at pages/index/my.uvue:632','没有保存的连接设备');\r\n\t\tthis.deviceStatus = '未连接';\r\n\t}\r\n},\r\n\r\n// 检查设备连接状态的核心方法\r\ncheckDeviceConnection(savedDeviceId, savedDeviceName) {\r\n\tuni.__f__('log','at pages/index/my.uvue:639','检查设备连接状态 - 核心方法', savedDeviceId);\r\n\t\r\n\t// 检查设备是否仍然连接\r\n\tuni.getConnectedBluetoothDevices({\r\n\t\tsuccess: (res) => {\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:644','获取已连接设备列表', res);\r\n\t\t\tconst isStillConnected = res.devices.some(device => device.deviceId === savedDeviceId);\r\n\t\t\t\r\n\t\t\tif (isStillConnected) {\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:648','设备仍然保持连接');\r\n\t\t\t\tthis.updateConnectedState(savedDeviceId, savedDeviceName);\r\n\t\t\t} else {\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:651','设备连接已断开');\r\n\t\t\t\tthis.clearConnectedDeviceStorage();\r\n\t\t\t\tthis.deviceStatus = '未连接';\r\n\t\t\t\t// 强制更新UI\r\n\t\t\t\tthis.$forceUpdate();\r\n\t\t\t}\r\n\t\t},\r\n\t\tfail: (err) => {\r\n\t\t\tuni.__f__('error','at pages/index/my.uvue:659','获取已连接设备列表失败', err);\r\n\t\t\t// 即使获取设备列表失败，也尝试检查设备服务，可能设备还在连接\r\n\t\t\tthis.updateConnectedState(savedDeviceId, savedDeviceName);\r\n\t\t\t\r\n\t\t\t// 尝试获取设备服务，验证连接是否有效\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.verifyConnectionStatus();\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t});\r\n},\r\n\r\n// 更新已连接状态的UI和逻辑\r\nupdateConnectedState(savedDeviceId, savedDeviceName) {\r\n\tuni.__f__('log','at pages/index/my.uvue:673','更新已连接状态', savedDeviceId);\r\n\t\r\n\t// 更新UI状态\r\n\tthis.connectedDeviceId = savedDeviceId;\r\n\tthis.deviceName = savedDeviceName || '未知设备';\r\n\tthis.deviceStatus = '已连接';\r\n\tthis.deviceInfo.show = true;\r\n\tthis.deviceInfo.connected = true;\r\n\tthis.deviceInfo.name = savedDeviceName || '未知设备';\r\n\t\r\n\t// 重置监听器状态并立即设置监听器\r\n\tthis.characteristicListenerSet = false;\r\n\tthis.setupCharacteristicListener();\r\n\r\n\t// 延迟重新获取设备服务和特征值，确保连接稳定\r\n\tsetTimeout(() => {\r\n\t\tthis.getBLEDeviceServices(savedDeviceId);\r\n\t}, 1000);\r\n\r\n\t// 启动连接监控\r\n\tthis.startConnectionMonitor();\r\n\t\r\n\t// 强制更新UI，确保用户看到连接状态\r\n\tthis.$forceUpdate();\r\n},\r\n\r\n\t\t// 连接设备\r\n\t\tconnectDevice(device) {\r\n\t\t\t// 保存当前组件实例的this引用，确保在所有回调中都能正确访问\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:703','连接设备', device);\r\n\t\t\tif (!that.bluetoothEnabled) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请先开启蓝牙',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// 如果已经有连接的设备，先断开\r\n\t\t\tif (that.connectedDeviceId && that.connectedDeviceId !== device.deviceId) {\r\n\t\t\t\tthat.disconnectDevice({deviceId: that.connectedDeviceId});\r\n\t\t\t}\r\n\r\n\t\t\tthat.deviceStatus = '连接中...';\r\n\t\t\t// 强制更新UI，让用户看到连接状态变化\r\n\t\t\tthat.$forceUpdate();\r\n\r\n\t\t\t// 使用uni-app的蓝牙API连接设备\r\n\t\t\tuni.createBLEConnection({\r\n\t\t\t\tdeviceId: device.deviceId,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:725','连接设备成功', res);\r\n\r\n\t\t\t\t\t// 立即更新设备状态，不等待后续操作\r\n\t\t\t\t\tdevice.connected = true;\r\n\t\t\t\t\tthat.connectedDeviceId = device.deviceId;\r\n\t\t\t\t\tthat.deviceName = device.name;\r\n\t\t\t\t\tthat.deviceStatus = '已连接';\r\n\t\t\t\t\tthat.deviceInfo.show = true;\r\n\t\t\t\t\tthat.deviceInfo.connected = true;\r\n\t\t\t\t\tthat.deviceInfo.name = device.name;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 重置监听器状态并立即设置监听器\r\n\t\t\t\t\tthat.characteristicListenerSet = false;\r\n\t\t\t\t\tthat.setupCharacteristicListener();\r\n\r\n\t\t\t\t\t// 延迟重新获取设备服务和特征值，确保连接稳定\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthat.getBLEDeviceServices(device.deviceId);\r\n\t\t\t\t\t}, 1000);\r\n\r\n\t\t\t\t\t// 启动连接监控\r\n\t\t\t\t\tthat.startConnectionMonitor();\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 强制更新UI，确保用户看到连接状态\r\n\t\t\t\t\tthat.$forceUpdate();\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:752','连接设备失败', err);\r\n\t\t\t\t\tthat.deviceStatus = '连接失败';\r\n\t\t\t\t\t// 强制更新UI，让用户看到连接失败\r\n\t\t\t\t\tthat.$forceUpdate();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// 启动连接监控\r\n\t\tstartConnectionMonitor() {\r\n\t\t\t// 清除现有的监控\r\n\t\t\tthis.stopConnectionMonitor();\r\n\r\n\t\t\t// 设置新的监控，每30秒检查一次连接状态\r\n\t\t\tthis.connectionMonitorInterval = setInterval(() => {\r\n\t\t\t\tif (this.connectedDeviceId) {\r\n\t\t\t\t\tthis.verifyConnectionStatus();\r\n\t\t\t\t}\r\n\t\t\t}, 30000); // 30秒检查一次\r\n\t\t},\r\n\r\n\t\t// 停止连接监控\r\n\t\tstopConnectionMonitor() {\r\n\t\t\tif (this.connectionMonitorInterval) {\r\n\t\t\t\tclearInterval(this.connectionMonitorInterval);\r\n\t\t\t\tthis.connectionMonitorInterval = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// 验证连接状态\r\n\t\tverifyConnectionStatus() {\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:783','验证设备连接状态');\r\n\t\t\tif (!this.connectedDeviceId) return;\r\n\r\n\t\t\t// 尝试获取设备服务来验证连接是否仍然有效\r\n\t\t\tuni.getBLEDeviceServices({\r\n\t\t\t\tdeviceId: this.connectedDeviceId,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:790','连接状态验证成功，设备仍然在线');\r\n\t\t\t\t\t// 连接正常，无需操作\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:794','连接状态验证失败，设备可能已断开', err);\r\n\t\t\t\t\t// 连接已断开，更新状态\r\n\t\t\t\t\tthis.handleUnexpectedDisconnect();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// 处理意外断开连接\r\n\t\thandleUnexpectedDisconnect() {\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:803','处理意外断开连接');\r\n\t\t\t// 停止连接监控\r\n\t\t\tthis.stopConnectionMonitor();\r\n\r\n\t\t\t// 更新UI状态\r\n\t\t\tthis.connectedDeviceId = '';\r\n\t\t\tthis.deviceName = '智能骑行传感器 A1';\r\n\t\t\tthis.deviceStatus = '连接丢失';\r\n\r\n\t\t\t// 更新设备信息显示\r\n\t\t\tif (this.deviceInfo.show) {\r\n\t\t\t\tthis.deviceInfo.connected = false;\r\n\t\t\t\t// 保留设备信息，但显示连接丢失状态\r\n\t\t\t}\r\n\r\n\t\t\t// 清除本地存储\r\n\t\t\tthis.clearConnectedDeviceStorage();\r\n\r\n\t\t\t// 移除监听器\r\n\t\t\tuni.offBLECharacteristicValueChange();\r\n\t\t\tthis.characteristicListenerSet = false;\r\n\r\n\t\t\t// 显示连接丢失提示\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '设备连接已丢失',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t},\r\n\t\t\t\r\n\t\t\t// 清除本地存储的连接状态\r\n\t\t\tclearConnectedDeviceStorage() {\r\n\t\t\t\tuni.removeStorageSync('connectedDeviceId');\r\n\t\t\t\tuni.removeStorageSync('connectedDeviceName');\r\n\t\t\t},\r\n\r\n\t\t\t// 连接设备\r\n\t\tconnectDevice(device) {\r\n\t\t\t// 保存当前组件实例的this引用，确保在所有回调中都能正确访问\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:842','连接设备', device);\r\n\t\t\tif (!that.bluetoothEnabled) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请先开启蓝牙',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// 如果已经有连接的设备，先断开\r\n\t\t\tif (that.connectedDeviceId && that.connectedDeviceId !== device.deviceId) {\r\n\t\t\t\tthat.disconnectDevice({deviceId: that.connectedDeviceId});\r\n\t\t\t}\r\n\r\n\t\t\tthat.deviceStatus = '连接中...';\r\n\t\t\t// 强制更新UI，让用户看到连接状态变化\r\n\t\t\tthat.$forceUpdate();\r\n\r\n\t\t\t// 使用uni-app的蓝牙API连接设备\r\n\t\t\tuni.createBLEConnection({\r\n\t\t\t\tdeviceId: device.deviceId,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:864','连接设备成功', res);\r\n\r\n\t\t\t\t\t// 立即更新设备状态，不等待后续操作\r\n\t\t\t\t\tdevice.connected = true;\r\n\t\t\t\t\tthat.connectedDeviceId = device.deviceId;\r\n\t\t\t\t\tthat.deviceName = device.name || '未知设备';\r\n\t\t\t\t\tthat.deviceStatus = '已连接';\r\n\t\t\t\t\tthat.deviceInfo.show = true;\r\n\t\t\t\t\tthat.deviceInfo.connected = true;\r\n\t\t\t\t\tthat.deviceInfo.name = device.name || '未知设备';\r\n\r\n\t\t\t\t\t// 立即设置监听器，确保不错过任何数据\r\n\t\t\t\t\tthat.setupCharacteristicListener();\r\n\r\n\t\t\t\t\t// 停止搜索\r\n\t\t\t\t\tthat.stopSearchDevices();\r\n\r\n\t\t\t\t\t// 保存连接状态到本地存储\r\n\t\t\t\t\tuni.setStorageSync('connectedDeviceId', device.deviceId);\r\n\t\t\t\t\tuni.setStorageSync('connectedDeviceName', device.name || '未知设备');\r\n\r\n\t\t\t\t\t// 延迟获取设备服务，确保连接稳定\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthat.getBLEDeviceServices(device.deviceId);\r\n\t\t\t\t\t}, 1000); // 增加延迟时间到1秒，确保连接完全稳定\r\n\r\n\t\t\t\t\t// 启动连接监控\r\n\t\t\t\t\tthat.startConnectionMonitor();\r\n\r\n\t\t\t\t\t// 强制更新UI，确保用户看到连接成功状态\r\n\t\t\t\tthat.$forceUpdate();\r\n\t\t\t\t\r\n\t\t\t\t// 连接成功后只打印一次deviceInfo当前状态\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:897','deviceInfo当前状态:', JSON.stringify(that.deviceInfo));\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '连接成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:905','连接设备失败', err);\r\n\t\t\t\t\tthat.deviceStatus = '连接失败';\r\n\t\t\t\t\t// 清除存储的连接状态\r\n\t\t\t\t\tthat.clearConnectedDeviceStorage();\r\n\t\t\t\t\t// 强制更新UI\r\n\t\t\t\t\tthat.$forceUpdate();\r\n\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '连接失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t\t// 断开设备连接\r\n\t\tdisconnectDevice(device) {\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:922','断开设备连接', device);\r\n\t\t\tconst that = this;\r\n\r\n\t\t\t// 使用uni-app的蓝牙API断开连接\r\n\t\t\tuni.closeBLEConnection({\r\n\t\t\t\tdeviceId: device.deviceId,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:929','断开设备连接成功', res);\r\n\r\n\t\t\t\t\t// 更新设备状态\r\n\t\t\t\t\tdevice.connected = false;\r\n\t\t\t\t\tif (that.connectedDeviceId === device.deviceId) {\r\n\t\t\t\t\t\tthat.connectedDeviceId = '';\r\n\t\t\t\t\t\tthat.deviceName = '智能骑行传感器 A1';\r\n\t\t\t\t\t\tthat.deviceStatus = '已断开';\r\n\t\t\t\t\t\t// 清空设备信息并隐藏显示\r\n\t\t\t\t\t\tthat.deviceInfo.show = false;\r\n\t\t\t\t\t\tthat.deviceInfo.connected = false;\r\n\t\t\t\t\t\tthat.deviceInfo.name = '';\r\n\t\t\t\t\t\tthat.deviceInfo.model = '';\r\n\t\t\t\t\t\tthat.deviceInfo.serialNumber = '';\r\n\t\t\t\t\t\tthat.deviceInfo.firmwareVersion = '';\r\n\t\t\t\t\t\tthat.deviceInfo.hardwareVersion = '';\r\n\t\t\t\t\t\tthat.deviceInfo.manufacturer = '';\r\n\t\t\t\t\t\tthat.deviceInfo.batteryLevel = '';\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 清除本地存储的连接状态\r\n\t\t\t\t\t\tthat.clearConnectedDeviceStorage();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 移除监听器\r\n\t\t\t\t\t\tuni.offBLECharacteristicValueChange();\r\n\t\t\t\t\t\tthat.characteristicListenerSet = false;\r\n\t\t\t\t\t\t// 停止连接监控\r\n\t\t\t\t\t\tthat.stopConnectionMonitor();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '已断开连接',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:964','断开设备连接失败', err);\r\n\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '断开失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t\t// 断开所有设备连接\r\n\t\tdisconnectAllDevices() {\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:976','断开所有设备连接');\r\n\t\t\tconst that = this;\r\n\r\n\t\t\t// 遍历所有已连接的设备并断开连接\r\n\t\t\tthat.discoveredDevices.forEach(device => {\r\n\t\t\t\tif (device.connected) {\r\n\t\t\t\t\tthat.disconnectDevice(device);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// 移除设备\r\n\t\tremoveDevice(device) {\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:989','移除设备', device);\r\n\t\t\tconst that = this;\r\n\r\n\t\t\t// 如果设备已连接，先断开连接\r\n\t\t\tif (device.connected) {\r\n\t\t\t\tthat.disconnectDevice(device);\r\n\t\t\t}\r\n\r\n\t\t\t// 从设备列表中移除\r\n\t\t\tconst index = that.discoveredDevices.findIndex(d => d.deviceId === device.deviceId);\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\tthat.discoveredDevices.splice(index, 1);\r\n\t\t\t}\r\n\r\n\t\t\t// 如果移除的是当前连接的设备，重置状态\r\n\t\t\tif (that.connectedDeviceId === device.deviceId) {\r\n\t\t\t\tthat.connectedDeviceId = '';\r\n\t\t\t\tthat.deviceName = '智能骑行传感器 A1';\r\n\t\t\t\tthat.deviceStatus = '已移除';\r\n\t\t\t}\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '已移除设备',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t\t// 获取蓝牙设备服务\r\n\t\tgetBLEDeviceServices(deviceId) {\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1018','获取设备服务', deviceId);\r\n\t\t\tconst that = this;\r\n\r\n\t\t\t// 清空之前的服务和特征值数据\r\n\t\t\tthat.bleServices = {};\r\n\t\t\tthat.bleCharacteristics = {};\r\n\r\n\t\t\tuni.getBLEDeviceServices({\r\n\t\t\t\tdeviceId: deviceId,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1028','获取设备服务成功', res);\r\n\r\n\t\t\t\t\t// 遍历所有服务\r\n\t\t\t\t\tres.services.forEach(service => {\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1032','服务UUID:', service.uuid);\r\n\t\t\t\t\t\t// 保存服务信息\r\n\t\t\t\t\t\tthat.bleServices[service.uuid] = service;\r\n\r\n\t\t\t\t\t\t// 获取服务特征值\r\n\t\t\t\t\t\tthat.getBLEDeviceCharacteristics(deviceId, service.uuid);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 如果是设备信息服务(0x180A)，尝试读取设备信息\r\n\t\t\t\t\tif (that.bleServices['0x180a'] || that.bleServices['180a']) {\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1042','找到设备信息服务，尝试读取设备信息');\r\n\t\t\t\t\t\t// 延迟一下，确保特征值已经获取\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthat.readDeviceInformation(deviceId);\r\n\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 如果是电池服务(0x180F)，尝试读取电池电量\r\n\t\t\t\t\tif (that.bleServices['0x180f'] || that.bleServices['180f']) {\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1051','找到电池服务，尝试读取电池电量');\r\n\t\t\t\t\t\t// 延迟一下，确保特征值已经获取\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthat.readBatteryLevel(deviceId);\r\n\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:1059','获取设备服务失败', err);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t\t\r\n\t\t\t// 读取设备信息\r\n\t\treadDeviceInformation(deviceId) {\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1067','尝试读取设备信息', deviceId);\r\n\t\t\t\r\n\t\t\t// UUID标准化函数\r\n\t\t\tconst normalizeUUID = (uuid) => {\r\n\t\t\t\t// 移除可能的前缀\r\n\t\t\t\tlet normalized = uuid.toLowerCase().replace(/^0x|^0X/g, '');\r\n\t\t\t\t// 移除可能的连字符\r\n\t\t\t\tnormalized = normalized.replace(/-/g, '');\r\n\t\t\t\treturn normalized;\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t// 查找设备信息服务，使用标准化的UUID进行匹配\r\n\t\t\tlet serviceId = null;\r\n\t\t\tconst serviceKeys = Object.keys(that.bleServices);\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1081','已发现的服务列表:', serviceKeys);\r\n\t\t\t\r\n\t\t\tfor (const key of serviceKeys) {\r\n\t\t\t\tconst normalizedKey = normalizeUUID(key);\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1085',`检查服务: ${key} (normalized: ${normalizedKey})`);\r\n\t\t\t\tif (normalizedKey === '180a') {\r\n\t\t\t\t\tserviceId = key;\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1088','找到设备信息服务:', serviceId);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (serviceId && that.bleCharacteristics[serviceId]) {\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1094','设备信息服务的特征值列表:', Object.keys(that.bleCharacteristics[serviceId]));\r\n\t\t\t\t// 尝试读取各种设备信息\r\n\t\t\t\tconst characteristicsToRead = [\r\n\t\t\t\t\t{ id: '2a24', key: 'model', name: '设备型号' },\r\n\t\t\t\t\t{ id: '2a25', key: 'serialNumber', name: '序列号' },\r\n\t\t\t\t\t{ id: '2a26', key: 'firmwareVersion', name: '固件版本' },\r\n\t\t\t\t\t{ id: '2a27', key: 'hardwareVersion', name: '硬件版本' },\r\n\t\t\t\t\t{ id: '2a28', key: 'softwareVersion', name: '软件版本' },\r\n\t\t\t\t\t{ id: '2a29', key: 'manufacturer', name: '制造商' }\r\n\t\t\t\t];\r\n\t\t\t\t\r\n\t\t\t\tlet readIndex = 0;\r\n\t\t\t\tconst readNextCharacteristic = () => {\r\n\t\t\t\t\tif (readIndex >= characteristicsToRead.length) {\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1108','设备信息读取完成');\r\n\t\t\t\t\t\treturn; // 所有特征值都已尝试读取\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst { id, key, name } = characteristicsToRead[readIndex];\r\n\t\t\t\t\tlet charId = null;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 查找特征值，使用标准化的UUID进行匹配\r\n\t\t\t\t\tconst charKeys = Object.keys(that.bleCharacteristics[serviceId]);\r\n\t\t\t\t\tfor (const charKey of charKeys) {\r\n\t\t\t\t\t\tconst normalizedCharKey = normalizeUUID(charKey);\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1119',`检查特征值: ${charKey} (normalized: ${normalizedCharKey})，寻找: ${id}`);\r\n\t\t\t\t\t\tif (normalizedCharKey === id) {\r\n\t\t\t\t\t\t\tcharId = charKey;\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1122',`找到${name}特征值: ${charId}`);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (charId) {\r\n\t\t\t\t\t\tconst char = that.bleCharacteristics[serviceId][charId];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 检查是否有读取权限\r\n\t\t\t\t\t\tif (char.properties.read) {\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1132',`尝试读取${name}: ${serviceId}/${charId}`);\r\n\t\t\t\t\t\t\t// 延迟读取，避免API调用过于频繁\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tthat.readDeviceCharacteristicValue(deviceId, serviceId, charId);\r\n\t\t\t\t\t\t\t\treadIndex++;\r\n\t\t\t\t\t\t\t\treadNextCharacteristic();\r\n\t\t\t\t\t\t\t}, 200);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1140',`${name}特征值不支持读取`);\r\n\t\t\t\t\t\t\t// 尝试启用通知（如果支持）\r\n\t\t\t\t\t\t\tif (char.properties.notify || char.properties.indicate) {\r\n\t\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1143',`尝试启用${name}特征值通知`);\r\n\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\tthat.notifyBLECharacteristicValueChange(deviceId, serviceId, charId);\r\n\t\t\t\t\t\t\t\t\treadIndex++;\r\n\t\t\t\t\t\t\t\t\treadNextCharacteristic();\r\n\t\t\t\t\t\t\t\t}, 200);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treadNextCharacteristic();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1154',`${name}特征值未找到 (寻找标准化的: ${id})`);\r\n\t\t\t\t\t\treadIndex++;\r\n\t\t\t\t\t\treadNextCharacteristic();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t// 开始按顺序读取特征值\r\n\t\t\t\treadNextCharacteristic();\r\n\t\t\t} else {\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1163','未找到设备信息服务或特征值');\r\n\t\t\t\t// 如果没有找到设备信息服务，尝试直接读取（可能服务UUID格式不同）\r\n\t\t\t\tthat.directReadDeviceInfo(deviceId);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t\t// 读取电池电量\r\n\t\treadBatteryLevel(deviceId) {\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1172','尝试读取电池电量', deviceId);\r\n\t\t\tconst serviceId = that.bleServices['0x180f'] ? '0x180f' : '180f';\r\n\t\t\tconst characteristicId = '0x2a19';\r\n\t\t\t\r\n\t\t\tif (serviceId && that.bleCharacteristics[serviceId] && \r\n\t\t\t\t(that.bleCharacteristics[serviceId][characteristicId] || \r\n\t\t\t\t that.bleCharacteristics[serviceId][characteristicId.replace('0x', '')])) {\r\n\t\t\t\tconst charId = that.bleCharacteristics[serviceId][characteristicId] ? \r\n\t\t\t\t\tcharacteristicId : characteristicId.replace('0x', '');\r\n\t\t\t\tconst char = that.bleCharacteristics[serviceId][charId];\r\n\t\t\t\t\r\n\t\t\t\t// 检查是否有读取权限\r\n\t\t\t\tif (char.properties.read) {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1185','尝试读取电池电量');\r\n\t\t\t\t\tthat.readDeviceCharacteristicValue(deviceId, serviceId, charId);\r\n\t\t\t\t} else if (char.properties.notify) {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1188','电池电量特征值支持通知，设置通知');\r\n\t\t\t\t\tthat.notifyBLECharacteristicValueChange(deviceId, serviceId, charId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// 获取蓝牙设备特征值\r\n\tgetBLEDeviceCharacteristics(deviceId, serviceId) {\r\n\t\t// 保存当前组件实例的this引用，确保在所有回调中都能正确访问\r\n\t\tconst that = this;\r\n\t\tuni.__f__('log','at pages/index/my.uvue:1198','获取设备特征值', deviceId, serviceId);\r\n\r\n\t\t// 初始化该服务的特征值对象\r\n\t\tif (!that.bleCharacteristics[serviceId]) {\r\n\t\t\tthat.bleCharacteristics[serviceId] = {};\r\n\t\t}\r\n\t\t\r\n\t\t// 设置特征值监听器（如果还没有设置）\r\n\t\tif (!that.characteristicListenerSet) {\r\n\t\t\tthat.setupCharacteristicListener();\r\n\t\t}\r\n\r\n\t\t\tuni.getBLEDeviceCharacteristics({\r\n\t\t\t\tdeviceId: deviceId,\r\n\t\t\t\tserviceId: serviceId,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1214','获取设备特征值成功', res);\r\n\r\n\t\t\t\t\t// 遍历所有特征值\r\n\t\t\t\t\tres.characteristics.forEach(characteristic => {\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1218','特征值UUID:', characteristic.uuid);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 保存特征值信息\r\n\t\t\t\t\t\tthat.bleCharacteristics[serviceId][characteristic.uuid] = characteristic;\r\n\r\n\t\t\t\t\t\t// 如果特征值支持通知或指示，则启用通知\r\n\t\t\t\t\t\tif (characteristic.properties.notify || characteristic.properties.indicate) {\r\n\t\t\t\t\t\t\tthat.notifyBLECharacteristicValueChange(deviceId, serviceId, characteristic.uuid);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 如果特征值支持读取，则读取设备信息\r\n\t\t\t\t\t\tif (characteristic.properties.read) {\r\n\t\t\t\t\t\t\t// 延迟读取，确保通知已正确设置\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tthat.readDeviceCharacteristicValue(deviceId, serviceId, characteristic.uuid);\r\n\t\t\t\t\t\t\t}, 200);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:1238','获取设备特征值失败', err);\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t\t// 启用蓝牙设备特征值变化通知\r\n\t\tnotifyBLECharacteristicValueChange(deviceId, serviceId, characteristicId) {\r\n\t\t\t// 保存当前组件实例的this引用，确保在所有回调中都能正确访问\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1247','启用蓝牙设备特征值变化通知', deviceId, serviceId, characteristicId);\r\n\r\n\t\t\t// 移除之前的监听器，避免重复监听\r\n\t\t\tuni.offBLECharacteristicValueChange();\r\n\r\n\t\t\t// 先监听特征值变化\r\n\t\t\tuni.onBLECharacteristicValueChange((res) => {\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1254','特征值变化', res);\r\n\t\t\t\t// 确保是当前连接的设备\r\n\t\t\t\tif (res.deviceId === that.connectedDeviceId) {\r\n\t\t\t\t\t// 处理接收到的数据\r\n\t\t\t\t\tthat.handleCharacteristicValueChange(res);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// 然后启用通知\r\n\t\t\tuni.notifyBLECharacteristicValueChange({\r\n\t\t\t\tdeviceId: deviceId,\r\n\t\t\t\tserviceId: serviceId,\r\n\t\t\t\tcharacteristicId: characteristicId,\r\n\t\t\t\tstate: true,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1269','启用蓝牙设备特征值变化通知成功', res);\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:1272','启用蓝牙设备特征值变化通知失败', err);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t\t// 处理接收到的数据\r\n\t\t\thandleReceivedData(buffer) {\r\n\t\t\t\t// 将ArrayBuffer转换为字符串\r\n\t\t\t\tconst str = this.ab2hex(buffer);\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1281','接收到的数据:', str);\r\n\r\n\t\t\t\t// 这里可以根据实际协议解析数据\r\n\t\t\t\t// 例如：解析传感器数据、控制命令等\r\n\t\t\t},\r\n\r\n\r\n\t\t\t// ArrayBuffer转16进制字符串\r\n\t\t\tab2hex(buffer) {\r\n\t\t\t\tconst hexArr = Array.prototype.map.call(\r\n\t\t\t\t\tnew Uint8Array(buffer),\r\n\t\t\t\t\tfunction (bit) {\r\n\t\t\t\t\t\treturn ('00' + bit.toString(16)).slice(-2)\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t\treturn hexArr.join('');\r\n\t\t\t},\r\n\r\n\t\t\t// 读取设备特征值数据\r\n\t\treadDeviceCharacteristicValue(deviceId, serviceId, characteristicId) {\r\n\t\t\t// 保存当前组件实例的this引用，确保在所有回调中都能正确访问\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1303','读取设备特征值数据', deviceId, serviceId, characteristicId);\r\n\r\n\t\t\tuni.readBLECharacteristicValue({\r\n\t\t\t\tdeviceId: deviceId,\r\n\t\t\t\tserviceId: serviceId,\r\n\t\t\t\tcharacteristicId: characteristicId,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1310','读取特征值成功', res);\r\n\t\t\t\t\t// 读取操作成功后，需要等待onBLECharacteristicValueChange回调获取数据\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:1314','读取特征值失败', err);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t\t// 监听特征值变化\r\n\t\tsetupCharacteristicListener() {\r\n\t\t\t// 保存当前组件实例的this引用，确保在所有回调中都能正确访问\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1323','设置特征值监听器');\r\n\t\t\t// 先移除可能存在的旧监听器\r\n\t\t\tuni.offBLECharacteristicValueChange();\r\n\t\t\t\r\n\t\t\t// 设置新的监听器\r\n\t\t\tuni.onBLECharacteristicValueChange(that.handleCharacteristicValueChange.bind(that));\r\n\t\t\tthat.characteristicListenerSet = true;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1330','特征值监听器设置完成');\r\n\t\t},\r\n\t\t\t\r\n\t\t\t// 直接读取设备信息（备用方法）\r\n\t\tdirectReadDeviceInfo(deviceId) {\r\n\t\t\t// 保存当前组件实例的this引用，确保在所有回调中都能正确访问\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1337','尝试直接读取设备信息');\r\n\t\t\t// UUID标准化函数\r\n\t\t\tconst normalizeUUID = (uuid) => {\r\n\t\t\t\t// 移除可能的前缀\r\n\t\t\t\tlet normalized = uuid.toLowerCase().replace(/^0x|^0X/g, '');\r\n\t\t\t\t// 移除可能的连字符\r\n\t\t\t\tnormalized = normalized.replace(/-/g, '');\r\n\t\t\t\treturn normalized;\r\n\t\t\t};\r\n\r\n\t\t\t// 尝试直接使用标准UUID读取设备信息，不依赖于服务发现\r\n\t\t\tconst serviceIds = ['0x180a', '180a', '0X180A', '0000180a-0000-1000-8000-00805f9b34fb'];\r\n\t\t\tconst characteristics = [\r\n\t\t\t\t{ id: '0x2a24', altIds: ['2a24', '00002a24-0000-1000-8000-00805f9b34fb'], key: 'model', name: '设备型号' },\r\n\t\t\t\t{ id: '0x2a25', altIds: ['2a25', '00002a25-0000-1000-8000-00805f9b34fb'], key: 'serialNumber', name: '序列号' },\r\n\t\t\t\t{ id: '0x2a26', altIds: ['2a26', '00002a26-0000-1000-8000-00805f9b34fb'], key: 'firmwareVersion', name: '固件版本' },\r\n\t\t\t\t{ id: '0x2a27', altIds: ['2a27', '00002a27-0000-1000-8000-00805f9b34fb'], key: 'hardwareVersion', name: '硬件版本' },\r\n\t\t\t\t{ id: '0x2a28', altIds: ['2a28', '00002a28-0000-1000-8000-00805f9b34fb'], key: 'softwareVersion', name: '软件版本' },\r\n\t\t\t\t{ id: '0x2a29', altIds: ['2a29', '00002a29-0000-1000-8000-00805f9b34fb'], key: 'manufacturer', name: '制造商' }\r\n\t\t\t];\r\n\r\n\t\t\tlet serviceIndex = 0;\r\n\t\t\tlet charIndex = 0;\r\n\t\t\tlet charIdIndex = 0;\r\n\r\n\t\t\tconst tryReadCharacteristic = () => {\r\n\t\t\t\tif (serviceIndex >= serviceIds.length) {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1364','直接读取设备信息完成');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (charIndex >= characteristics.length) {\r\n\t\t\t\t\t// 尝试下一个服务\r\n\t\t\t\t\tserviceIndex++;\r\n\t\t\t\t\tcharIndex = 0;\r\n\t\t\t\t\tcharIdIndex = 0;\r\n\t\t\t\t\ttryReadCharacteristic();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst serviceId = serviceIds[serviceIndex];\r\n\t\t\t\tconst { id, altIds, key, name } = characteristics[charIndex];\r\n\r\n\t\t\t\t// 获取当前要尝试的特征值ID\r\n\t\t\t\tconst allCharIds = [id, ...altIds];\r\n\t\t\t\tif (charIdIndex >= allCharIds.length) {\r\n\t\t\t\t\t// 当前特征值的所有ID都尝试过了，尝试下一个特征值\r\n\t\t\t\t\tcharIndex++;\r\n\t\t\t\t\tcharIdIndex = 0;\r\n\t\t\t\t\ttryReadCharacteristic();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst characteristicId = allCharIds[charIdIndex];\r\n\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1392',`尝试直接读取 ${name}: ${serviceId}/${characteristicId}`);\r\n\r\n\t\t\t\tuni.readBLECharacteristicValue({\r\n\t\t\t\t\tdeviceId: deviceId,\r\n\t\t\t\tserviceId: serviceId,\r\n\t\t\t\tcharacteristicId: characteristicId,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1399',`直接读取${name}成功，等待数据回调`, res);\r\n\t\t\t\t\t// 读取成功后，继续尝试下一个特征值\r\n\t\t\t\t\tcharIndex++;\r\n\t\t\t\t\tcharIdIndex = 0;\r\n\t\t\t\t\tsetTimeout(tryReadCharacteristic, 300);\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1406',`直接读取${name}失败 (${serviceId}/${characteristicId}):`, err);\r\n\t\t\t\t\t// 尝试当前特征值的下一个ID格式\r\n\t\t\t\t\tcharIdIndex++;\r\n\t\t\t\t\tsetTimeout(tryReadCharacteristic, 100);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t// 开始尝试读取\r\n\t\t\ttryReadCharacteristic();\r\n\t\t},\r\n\t\t\t\r\n\t\t\t// 处理特征值变化\r\n\t\thandleCharacteristicValueChange(res) {\r\n\t\t\t// 保存当前组件实例的this引用，确保在所有回调中都能正确访问\r\n\t\t\tconst that = this;\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1422','特征值变化', res);\r\n\t\t\tconst { deviceId, serviceId, characteristicId, value } = res;\r\n\r\n\t\t\t// 确保是当前连接的设备\r\n\t\t\tif (deviceId !== that.connectedDeviceId) {\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1427','忽略非当前连接设备的数据');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// 将ArrayBuffer转换为16进制字符串\r\n\t\t\tconst hexString = that.ab2hex(value);\r\n\t\t\t// 将ArrayBuffer转换为字符串\r\n\t\t\tconst strValue = that.ab2str(value);\r\n\r\n\t\t\t// 标准化UUID格式（移除前缀并转为小写）\r\n\t\t\tconst normalizeUUID = (uuid) => {\r\n\t\t\t\t// 移除可能的前缀\r\n\t\t\t\tlet normalized = uuid.toLowerCase().replace(/^0x|^0X/g, '');\r\n\t\t\t\t// 移除可能的连字符\r\n\t\t\t\tnormalized = normalized.replace(/-/g, '');\r\n\t\t\t\treturn normalized;\r\n\t\t\t};\r\n\r\n\t\t\tconst normalizedServiceId = normalizeUUID(serviceId);\r\n\t\t\tconst normalizedCharId = normalizeUUID(characteristicId);\r\n\r\n\t\t\tuni.__f__('log','at pages/index/my.uvue:1448',`Service: ${serviceId} (normalized: ${normalizedServiceId}), Characteristic: ${characteristicId} (normalized: ${normalizedCharId}), Value: ${hexString}, String: \"${strValue}\"`);\r\n\r\n\t\t\t// 确保设备信息区域显示\r\n\t\t\tif (!that.deviceInfo.show) {\r\n\t\t\t\tthat.deviceInfo.show = true;\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1453','设置deviceInfo.show为true');\r\n\t\t\t}\r\n\r\n\t\t\t// 处理电池电量\r\n\t\t\tif (normalizedServiceId === '180f') {\r\n\t\t\t\tif (normalizedCharId === '2a19') {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// 电池电量是一个字节的数值 (0-100)\r\n\t\t\t\t\t\tconst batteryLevel = new Uint8Array(value)[0];\r\n\t\t\t\t\t\tthat.deviceInfo.batteryLevel = `${batteryLevel}%`;\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1463','电池电量:', that.deviceInfo.batteryLevel);\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:1465','解析电池电量失败:', error);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// 处理设备信息\r\n\t\t\tif (normalizedServiceId === '180a') {\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1472','检测到设备信息服务(180a)，处理特征值:', normalizedCharId);\r\n\t\t\t\tswitch (normalizedCharId) {\r\n\t\t\t\t\tcase '2a24': // Model\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1475','检测到设备型号特征值(2a24)，原始值:', strValue);\r\n\t\t\t\t\t\tif (strValue && strValue.trim()) {\r\n\t\t\t\t\t\t\tthat.deviceInfo.model = strValue.trim();\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1478','更新设备型号为:', that.deviceInfo.model);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1480','设备型号值为空或只有空白字符');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase '2a25': // Serial Number\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1484','检测到序列号特征值(2a25)，原始值:', strValue);\r\n\t\t\t\t\t\tif (strValue && strValue.trim()) {\r\n\t\t\t\t\t\t\tthat.deviceInfo.serialNumber = strValue.trim();\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1487','更新序列号为:', that.deviceInfo.serialNumber);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1489','序列号值为空或只有空白字符');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase '2a26': // Firmware Version\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1493','检测到固件版本特征值(2a26)，原始值:', strValue);\r\n\t\t\t\t\t\tif (strValue && strValue.trim()) {\r\n\t\t\t\t\t\t\tthat.deviceInfo.firmwareVersion = strValue.trim();\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1496','更新固件版本为:', that.deviceInfo.firmwareVersion);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1498','固件版本值为空或只有空白字符');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase '2a27': // Hardware Version\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1502','检测到硬件版本特征值(2a27)，原始值:', strValue);\r\n\t\t\t\t\t\tif (strValue && strValue.trim()) {\r\n\t\t\t\t\t\t\tthat.deviceInfo.hardwareVersion = strValue.trim();\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1505','更新硬件版本为:', that.deviceInfo.hardwareVersion);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1507','硬件版本值为空或只有空白字符');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase '2a28': // Software Version\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1511','检测到软件版本特征值(2a28)，原始值:', strValue);\r\n\t\t\t\t\t\tif (strValue && strValue.trim()) {\r\n\t\t\t\t\t\t\tthat.deviceInfo.softwareVersion = strValue.trim();\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1514','更新软件版本为:', that.deviceInfo.softwareVersion);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1516','软件版本值为空或只有空白字符');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase '2a29': // Manufacturer Name\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1520','检测到制造商特征值(2a29)，原始值:', strValue);\r\n\t\t\t\t\t\tif (strValue && strValue.trim()) {\r\n\t\t\t\t\t\t\tthat.deviceInfo.manufacturer = strValue.trim();\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1523','更新制造商为:', that.deviceInfo.manufacturer);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1525','制造商值为空或只有空白字符');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1529','未识别的设备信息特征值:', normalizedCharId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 立即强制更新设备名称\r\n\t\t\tif (that.deviceName === '智能骑行传感器 A1' && strValue && strValue.trim()) {\r\n\t\t\t\t// 尝试从设备信息中获取设备名称\r\n\t\t\t\tif (normalizedCharId === '2a24' || normalizedCharId === '2a29') {\r\n\t\t\t\t\tthat.deviceName = strValue.trim();\r\n\t\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1538','更新设备名称为:', that.deviceName);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 记录deviceInfo当前状态\r\n\t\t\t// 强制更新UI，确保用户能看到最新状态\r\n\t\t\tthat.$forceUpdate();\r\n\t\t\t// uni.__f__('log','at pages/index/my.uvue:1545','强制更新UI后');\r\n\t\t},\r\n\r\n\t\t\t// ArrayBuffer转字符串\r\n\t\t\tab2str(buffer) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// 直接使用String.fromCharCode实现，确保在所有环境中都能正常工作\r\n\t\t\t\t\tconst uint8Array = new Uint8Array(buffer);\r\n\t\t\t\t\tlet result = String.fromCharCode.apply(null, uint8Array);\r\n\t\t\t\t\t// 移除可能的空字符和控制字符\r\n\t\t\t\t\tresult = result.replace(/[\\x00-\\x1F\\x7F]/g, '');\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tuni.__f__('error','at pages/index/my.uvue:1558','字符串转换失败:', error);\r\n\t\t\t\t\t// 最终备用方案\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 切换标签页\r\n\t\t\tswitchTab(tab) {\r\n\t\t\t\tthis.activeTab = tab;\r\n\t\t\t\tuni.__f__('log','at pages/index/my.uvue:1567','切换到标签页:', tab);\r\n\t\t\t\t// 这里可以添加切换标签页的逻辑\r\n\t\t\t\tif (tab === 'riding') {\r\n\t\t\t\t\t// 跳转到骑行页面\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: '/pages/index/index'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n}\t\t\r\n</script>\r\n\r\n<style>\r\n\t.container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\theight: 100vh;\r\n\t\tpadding: 10px;\r\n\t\tbackground-color: #f5f5f5;\r\n\t}\r\n\r\n\t/* 顶部数据区域样式 */\r\n\t.data-section {\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder-radius: 10px;\r\n\t\tpadding: 10px;\r\n\t\t/* 减小内边距 */\r\n\t\tmargin-bottom: 10px;\r\n\t\tbox-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\r\n\t\theight: 200px;\r\n\t\t/* 固定高度，减小一半左右 */\r\n\t}\r\n\r\n\t.section-title {\r\n\t\tfont-size: 16px;\r\n\t\t/* 减小字体大小 */\r\n\t\tfont-weight: bold;\r\n\t\tmargin-bottom: 5px;\r\n\t\t/* 减小下边距 */\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.data-list {\r\n\t\tbackground-color: #f9f9f9;\r\n\t\tborder-radius: 8px;\r\n\t\toverflow: hidden;\r\n\t\theight: calc(100% - 25px);\r\n\t\t/* 计算剩余高度 */\r\n\t}\r\n\r\n\t.data-list-item {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 8px 10px;\r\n\t\t/* 减小内边距 */\r\n\t\tborder-bottom: 1px solid #eee;\r\n\t}\r\n\r\n\t.data-list-item:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t.data-list-label {\r\n\t\tfont-size: 14px;\r\n\t\t/* 减小字体大小 */\r\n\t\tcolor: #666;\r\n\t}\r\n\r\n\t.data-list-value {\r\n\t\tfont-size: 14px;\r\n\t\t/* 减小字体大小 */\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t/* 中间历史骑行数据区域样式 */\r\n\t.history-section {\r\n\t\tflex: 1;\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder-radius: 10px;\r\n\t\tpadding: 15px;\r\n\t\tmargin-bottom: 10px;\r\n\t\tbox-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t}\r\n\r\n\t.history-list {\r\n\t\tflex: 1;\r\n\t\toverflow-y: auto;\r\n\t}\r\n\r\n\t.history-item {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tpadding: 15px;\r\n\t\tborder-bottom: 1px solid #eee;\r\n\t}\r\n\r\n\t.history-item:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t.history-date {\r\n\t\tmargin-bottom: 8px;\r\n\t}\r\n\r\n\t.date-text {\r\n\t\tfont-size: 16px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.history-details {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.time-text {\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #666;\r\n\t}\r\n\r\n\t.location-text {\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #666;\r\n\t}\r\n\r\n\t/* 底部设备区域样式 */\r\n\t.device-area {\r\n\t\t\tbackground-color: #ffffff;\r\n\t\t\tborder-radius: 10px;\r\n\t\t\tpadding: 15px;\r\n\t\t\tmargin-bottom: 10px;\r\n\t\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n\t\t}\r\n\t\t\r\n\t\t/* 设备信息显示区域样式 */\r\n\t\t.device-info-section {\r\n\t\t\tbackground-color: #f8f8f8;\r\n\t\t\tborder-radius: 8px;\r\n\t\t\tpadding: 10px;\r\n\t\t\tmargin: 10px 0;\r\n\t\t\tborder: 1px solid #e0e0e0;\r\n\t\t}\r\n\t\t\r\n\t\t.device-info-item {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\talign-items: center;\r\n\t\t\tpadding: 8px 0;\r\n\t\t\tborder-bottom: 1px solid #f0f0f0;\r\n\t\t}\r\n\t\t\r\n\t\t.device-info-item:last-child {\r\n\t\t\tborder-bottom: none;\r\n\t\t}\r\n\t\t\r\n\t\t.device-info-label {\r\n\t\t\tfont-size: 14px;\r\n\t\t\tcolor: #666666;\r\n\t\t}\r\n\t\t\r\n\t\t.device-info-value {\r\n\t\t\tfont-size: 14px;\r\n\t\t\tcolor: #333333;\r\n\t\t\tfont-weight: 500;\r\n\t\t}\r\n\t\t\r\n\t\t.device-info-value.battery {\r\n\t\t\t\tcolor: #07c160;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.device-info-value.connected {\r\n\t\t\t\tcolor: #07c160;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.device-info-value.disconnected {\r\n\t\t\t\tcolor: #ff4d4f;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t}\r\n\r\n\t.device-container {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tpadding: 20px 0;\r\n\t}\r\n\r\n\t.device-box {\r\n\t\twidth: 200px;\r\n\t\theight: 120px;\r\n\t\tbackground-color: #f0f0f0;\r\n\t\tborder: 2px dashed #ccc;\r\n\t\tborder-radius: 8px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.device-name {\r\n\t\tfont-size: 16px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 8px;\r\n\t}\r\n\r\n\t.device-status {\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #FF5722;\r\n\t}\r\n\r\n\t.search-hint {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #FF5722;\r\n\t\tmargin-top: 5px;\r\n\t}\r\n\r\n\t.device-list {\r\n\t\tmargin-top: 15px;\r\n\t\tborder-top: 1px solid #eee;\r\n\t\tpadding-top: 15px;\r\n\t}\r\n\r\n\t.device-list-item {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tpadding: 15px;\r\n\t\tborder-bottom: 1px solid #eee;\r\n\t\tbackground-color: #f9f9f9;\r\n\t\tborder-radius: 8px;\r\n\t\tmargin-bottom: 10px;\r\n\t}\r\n\r\n\t.device-list-item:last-child {\r\n\t\tborder-bottom: none;\r\n\t\tmargin-bottom: 0;\r\n\t}\r\n\r\n\t.device-item-name {\r\n\t\tfont-size: 16px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 5px;\r\n\t}\r\n\r\n\t.device-item-signal {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #666;\r\n\t\tmargin-bottom: 10px;\r\n\t}\r\n\r\n\t.device-item-actions {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: flex-end;\r\n\t\tgap: 10px;\r\n\t}\r\n\r\n\t.action-button {\r\n\t\tpadding: 5px 10px;\r\n\t\tbackground-color: #f0f0f0;\r\n\t\tborder-radius: 4px;\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.action-button:active {\r\n\t\tbackground-color: #e0e0e0;\r\n\t}\r\n\r\n\r\n\r\n\r\n</style>\r\n\r\n\r\n\r\n","import MiniProgramPage from 'E:/GitLab/ESP32/HBuilderX.4.76.2025082103/RideApp/uniappRide/pages/index/my.uvue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","uni","res","__values"],"mappings":"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"}